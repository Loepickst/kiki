<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>日语敬语学习</title>
    <style>
        /* --- 1. 全局配置 --- */
        :root {
            --primary: #5c6bc0;    /* 主题蓝 */
            --accent: #ff7043;     /* 强调橙 */
            --bg: #f5f7fa;
            --white: #ffffff;
            --text: #2c3e50;
            --drill-bg: #e8eaf6;   /* 练习模式背景色 */
            --scenario-bg: #fff3e0;/* 场景模式背景色 */
        }

        body {
            font-family: 'Hiragino Sans', 'Microsoft YaHei', sans-serif;
            margin: 0;
            background-color: var(--bg);
            color: var(--text);
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* --- 2. 顶部主导航 --- */
        .navbar {
            background: var(--white);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            height: 60px;
            flex-shrink: 0;
            z-index: 100;
        }

        .nav-item {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #999;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: 0.3s;
        }

        .nav-item.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background-color: #f8f9ff;
        }

        /* --- 3. 内容容器 --- */
        .main-content {
            flex-grow: 1;
            overflow-y: auto;
            /* 👇 修改这里：把原来的 20px 改小，并加上 flex 布局 */
            padding: 10px 20px; 
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* 强制内容靠上对齐 */
            -webkit-overflow-scrolling: touch;
        }
        
        /* 👇 新增这个样式：控制台卡片 */
        .practice-controls {
            padding: 15px; 
            margin-bottom: 15px; 
            margin-top: 0; /* 关键：去掉顶部间距 */
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            gap: 10px; 
            position: relative;
        }
        
        /* 手机适配补充 */
        @media screen and (max-width: 600px) {
            .main-content { padding: 10px; }
            .practice-controls { padding: 12px; }
        }

        .container { max-width: 800px; margin: 0 auto; }

        .panel { display: none; }
        .panel.active { display: block; animation: fadeIn 0.4s; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* 通用卡片 */
        .card {
            background: var(--white);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }

        /* 表格样式 (复用之前的) */
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #eee; padding: 12px; }
        th { background: #eef6ff; color: var(--primary); }

        /* --- 4. 练习板块专属样式 (核心修改) --- */
        
        /* 练习模式切换器 */
        .practice-switcher {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .switch-btn {
            padding: 10px 20px;
            border: 2px solid #ddd;
            border-radius: 20px;
            background: white;
            color: #666;
            cursor: pointer;
            font-weight: bold;
            transition: 0.2s;
        }

        .switch-btn.active {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 6px rgba(92, 107, 192, 0.3);
        }

        /* 题目容器 */
        .quiz-section { display: none; } /* 默认隐藏所有练习子模块 */
        .quiz-section.active { display: block; }

        .quiz-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 5px solid #ddd;
            box-shadow: 0 2px 5px rgba(0,0,0,0.03);
        }

        /* 标签：区分题目类型 */
        .tag {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .tag-ident { background: #e1f5fe; color: #0288d1; } /* 辨析题颜色 */
        .tag-scene { background: #fff3e0; color: #ef6c00; } /* 场景题颜色 */

        .question-text { font-size: 1.1rem; font-weight: bold; margin-bottom: 15px; }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* 两列布局 */
            gap: 10px;
        }

        .btn-opt {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            text-align: center; /* 选项居中 */
            transition: 0.2s;
        }
        .btn-opt:hover { background-color: #f5f5f5; border-color: #bbb; }
        
        /* 答案反馈色 */
        .btn-opt.correct { background: #d4edda; border-color: #28a745; color: #155724; }
        .btn-opt.wrong { background: #f8d7da; border-color: #dc3545; color: #721c24; }

        .feedback { margin-top: 10px; font-size: 0.9rem; display: none; padding: 10px; background: #fafafa; border-radius: 5px; }
         /* ========================================= */
        /* 📱 手机端专属优化 (Mobile Responsive) - 终极修复版 */
        /* ========================================= */
        @media screen and (max-width: 600px) {
            /* 1. 缩小全局字号 */
            body { font-size: 14px; } 
            
            /* 2. 压缩导航栏 */
            .navbar { height: 50px; }
            .nav-item { font-size: 0.85rem; padding: 0 5px; } /* 导航字更小 */
            
            /* 3. 压缩卡片 */
            .main-content { padding: 8px; }
            .card { padding: 15px 12px; margin-bottom: 12px; } /* 左右内边距更窄 */
            
            /* 4. 标题变小 */
            h2 { font-size: 1.2rem; }
            h3 { font-size: 1.05rem; }
            strong { font-size: 0.95rem; }

            /* --- 5. 表格强力压缩 (核心修改) --- */
            /* 强制缩小整个表格的基础字号 */
            .honorific-table { 
                font-size: 0.75rem !important; /* 12px 左右 */
            } 
            
            .honorific-table th, 
            .honorific-table td { 
                padding: 6px 3px !important; /* 极窄内边距，挤出空间 */
            }

            /* 重点：强制缩小加粗的核心词 */
            .word-item { 
                font-size: 0.85rem !important; /* 13.6px 左右，比电脑端小很多 */
                margin-bottom: 1px;
                line-height: 1.3;
            }
            
            /* 假名注音缩到最小 */
            rt { font-size: 0.5rem; } 

            /* 让表格里的注释说明换行显示，不挤在一起 */
            .note { 
                display: block; 
                margin-top: 1px; 
                font-size: 0.7rem; 
                transform: scale(0.9); /* 强行再缩小一点 */
                transform-origin: left top;
            } 
            
            /* 6. 练习题按钮变竖排 */
            .options-grid { grid-template-columns: 1fr; }
            .switch-btn { padding: 8px 10px; font-size: 0.8rem; }
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="nav-item" onclick="location.href='practice.html'" style="flex: 0 0 60px; font-size: 1.2rem; border-bottom: none; color: #555;">←</div>
        <div class="nav-item active" onclick="switchMainTab('basic')">1. 基础理论</div>
        <div class="nav-item" onclick="switchMainTab('special')">2. 特殊敬语表</div>
        <div class="nav-item" onclick="switchMainTab('practice')">3. 分层练习</div>
    </nav>

    <div class="main-content">
        <div class="container">

            <div id="basic" class="panel active">
                <div class="card" style="text-align: center; padding: 20px; border-bottom: 4px solid #ddd;">
    <h2 style="margin:0; color:#333;">敬语知识体系</h2>
    <p style="color:#666; margin-top:5px; font-size:0.9rem;">基础礼貌  ➜ 特定对象的尊敬 </p>
</div>

<div class="card" style="border-top: 5px solid #607d8b;">
    <div style="border-bottom: 1px solid #eee; margin-bottom: 15px; padding-bottom: 10px;">
        <span style="background:#607d8b; color:white; padding:4px 8px; border-radius:4px; font-size:0.8rem; margin-right:10px;">Step 0</span>
        <strong style="font-size:1.2rem; color:#455a64;">😝 郑重语 </strong>
    </div>

    <div style="background:#f5f7f8; padding:10px 15px; border-left:4px solid #607d8b; margin-bottom:20px;">
        <strong>定义：</strong> 不考虑对方地位高低，为了保持<strong>“得体、礼貌”</strong>而使用的语言。<br>
        <span style="color:#78909c; font-size:0.9em;">(即：让你的日语听起来像个文明的成年人)</span>
    </div>

    <div style="background: #eceff1; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
        <h4 style="margin-top: 0; color: #37474f;">1. 基础形式 </h4>
        <div style="display:grid; gap:10px;">
            <div style="background:white; padding:10px; border-radius:5px;">
                <span style="color:#999; font-size:0.85em;">普通 → 礼貌</span><br>
                明日、東京へ<strong>行く</strong>。<br>
                ↓<br>
                明日、東京へ<strong>行きます</strong>。<br>
                <span style="color:#607d8b; font-size:0.9em;">(明天去东京。)</span>
            </div>
        </div>
    </div>

    <div style="background: #eceff1; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
        <h4 style="margin-top: 0; color: #37474f;">2. 特殊郑重语</h4>
        <p style="font-size:0.9em; margin-bottom:15px;">
            在<strong>服务业、商务接待、正式演讲</strong>中，通常会将「です/ます」替换成一些特殊的表达。
        </p>
        
        <table style="width:100%; border-collapse:collapse; background:white; font-size:0.95rem;">
            <tr style="background:#f0f4f8; color:#546e7a;">
                <th style="padding:10px; text-align:left; border-bottom:2px solid #ddd;">原词</th>
                <th style="padding:10px; text-align:left; border-bottom:2px solid #ddd;">升级版</th>
                <th style="padding:10px; text-align:left; border-bottom:2px solid #ddd;">💬 经典语境例句</th>
            </tr>

            <tr style="border-bottom:1px solid #eee;">
                <td style="padding:10px; color:#666;">ある<br><small>(有/在)</small></td>
                <td style="padding:10px; font-weight:bold; color:#d84315;">ございます</td>
                <td style="padding:10px;">
                    <span style="background:#e3f2fd; padding:2px 6px; border-radius:4px; font-size:0.8em; color:#1565c0;">店员</span> 
                    トイレはあちらに<strong>ございます</strong>。<br>
                    <span style="color:#888; font-size:0.85em;">(洗手间在那边。)</span>
                </td>
            </tr>

            <tr style="border-bottom:1px solid #eee;">
                <td style="padding:10px; color:#666;">です<br><small>(是)</small></td>
                <td style="padding:10px; font-weight:bold; color:#d84315;">でございます</td>
                <td style="padding:10px;">
                    <span style="background:#e3f2fd; padding:2px 6px; border-radius:4px; font-size:0.8em; color:#1565c0;">电话</span> 
                    はい、担当の田中<strong>でございます</strong>。<br>
                    <span style="color:#888; font-size:0.85em;">(您好，我是负责这项工作的田中。)</span>
                </td>
            </tr>

            <tr style="border-bottom:1px solid #eee;">
                <td style="padding:10px; color:#666;">いい<br><small>(好)</small></td>
                <td style="padding:10px; font-weight:bold; color:#d84315;">よろしい</td>
                <td style="padding:10px;">
                    <span style="background:#e3f2fd; padding:2px 6px; border-radius:4px; font-size:0.8em; color:#1565c0;">确认</span> 
                    ご注文は以上で<strong>よろしい</strong>でしょうか。<br>
                    <span style="color:#888; font-size:0.85em;">(您点的餐就是这些，没问题吧？)</span>
                </td>
            </tr>

            <tr style="border-bottom:1px solid #eee;">
                <td style="padding:10px; color:#666;">どう<br><small>(怎么样)</small></td>
                <td style="padding:10px; font-weight:bold; color:#d84315;">いかが</td>
                <td style="padding:10px;">
                    <span style="background:#e3f2fd; padding:2px 6px; border-radius:4px; font-size:0.8em; color:#1565c0;">推荐</span> 
                    食後のコーヒーは<strong>いかが</strong>ですか。<br>
                    <span style="color:#888; font-size:0.85em;">(饭后来杯咖啡怎么样？)</span>
                </td>
            </tr>
            
            <tr>
                <td style="padding:10px; color:#666;">今日<br><small>(今天)</small></td>
                <td style="padding:10px; font-weight:bold; color:#d84315;">本日<br><small>(honjitsu)</small></td>
                <td style="padding:10px;">
                    <span style="background:#e3f2fd; padding:2px 6px; border-radius:4px; font-size:0.8em; color:#1565c0;">广播</span> 
                    <strong>本日</strong>はご来店ありがとうございます。<br>
                    <span style="color:#888; font-size:0.85em;">(感谢您今天的莅临。)</span>
                </td>
            </tr>
        </table>
    </div>

    <div style="background: #eceff1; padding: 15px; border-radius: 8px;">
        <h4 style="margin-top: 0; color: #37474f; border-bottom: 2px solid #cfd8dc; padding-bottom: 10px;">
            3. 美化语 
        </h4>
        
        <p style="font-size: 0.95em; color: #455a64; margin-bottom: 15px;">
            <strong>定义：</strong> 为了让语言听起来<strong>“优雅、有教养”</strong>而添加前缀，对此进行美化。<br>
            <span style="font-size: 0.85em; color: #78909c;">（区别：尊他语是为了尊敬对方，而美化语是为了修饰自己。）</span>
        </p>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            
            <div style="background: white; padding: 10px; border-radius: 6px; border: 1px solid #d1d9e6;">
                <strong style="color: #e91e63; font-size: 0.9em;">🍱 饮食类</strong>
                <ul style="margin: 5px 0 0 0; padding-left: 20px; font-size: 0.9em; color: #555;">
                    <li><strong>お</strong>酒 (酒)</li>
                    <li><strong>お</strong>米 (米)</li>
                    <li><strong>お</strong>水 (水)</li>
                    <li><strong>ご</strong>飯 (饭)</li>
                </ul>
            </div>

            <div style="background: white; padding: 10px; border-radius: 6px; border: 1px solid #d1d9e6;">
                <strong style="color: #2196f3; font-size: 0.9em;">🏠 生活类</strong>
                <ul style="margin: 5px 0 0 0; padding-left: 20px; font-size: 0.9em; color: #555;">
                    <li><strong>お</strong>風呂 (洗澡)</li>
                    <li><strong>お</strong>部屋 (房间)</li>
                    <li><strong>お</strong>化粧 (化妆)</li>
                    <li><strong>お</strong>店 (商店)</li>
                </ul>
            </div>
        </div>

        <div style="margin-top: 15px; background: white; padding: 10px; border-radius: 6px; border: 1px solid #d1d9e6;">
            <strong style="color: #ff9800; font-size: 0.9em;">🔒 必须加“お”的词 (固定搭配)</strong>
            <p style="font-size: 0.85em; color: #666; margin: 5px 0;">
                有些词如果不加“お”，意思会变或者显得极其粗鲁，已经变成了单词的一部分。
            </p>
            <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-top: 5px;">
                <span style="background:#fff3e0; padding:2px 8px; border-radius:4px; font-size:0.85em;">お腹 (肚子)</span>
                <span style="background:#fff3e0; padding:2px 8px; border-radius:4px; font-size:0.85em;">おかず (菜肴)</span>
                <span style="background:#fff3e0; padding:2px 8px; border-radius:4px; font-size:0.85em;">おやつ (零食)</span>
                <span style="background:#fff3e0; padding:2px 8px; border-radius:4px; font-size:0.85em;">おにぎり (饭团)</span>
            </div>
        </div>

        <p style="font-size: 0.85em; color: #b0bec5; margin-top: 15px; border-top: 1px dashed #cfd8dc; padding-top: 10px;">
            🚫 <strong>避坑：</strong> 外来语（如コーヒー、ビール）通常不加美化语。<br>
            也不要为了“优雅”而给所有词都加お，比如“おズボン (裤子)”听起来会有点过于幼稚或阴柔。
        </p>
    </div>
</div>

<div class="card" style="border-top: 5px solid #4a90e2;">
    <div style="border-bottom: 1px solid #eee; margin-bottom: 15px; padding-bottom: 10px;">
        <span style="background:#4a90e2; color:white; padding:4px 8px; border-radius:4px; font-size:0.8rem; margin-right:10px;">Step 1</span>
        <strong style="font-size:1.2rem; color:#0056b3;">⬆️ 尊他语 (对方做)</strong>
    </div>

    <div style="background:#e3f2fd; padding:10px 15px; border-left:4px solid #4a90e2; margin-bottom:20px;">
        <strong>定义：</strong> 动作主语是<strong>“听话人”</strong>或<strong>“长辈/上级”</strong>。<br>
        通过<span style="color:#0277bd; font-weight:bold;">抬高</span>这个动作，来表示尊重。<br>
    </div>

    <div style="background: #f0f7ff; padding: 15px; border-radius: 8px;">
        <h4 style="margin-top: 0; color: #0056b3; border-bottom:1px solid #cce5ff; padding-bottom:10px; margin-bottom:15px;">常见尊他句式 </h4>

        <div style="margin-bottom: 25px;">
            <strong style="color:#0277bd; font-size:1.1em;">① お + <span style="color:#e74c3c;">动词第一连用形</span> + になる</strong>
            <span style="background:#0277bd; color:white; font-size:0.7em; padding:2px 5px; border-radius:3px; vertical-align:middle; margin-left:5px;">最标准/最正式</span>
            
            <div style="margin-top:10px; display:grid; gap:8px;">
                <div style="background:white; padding:10px; border-radius:6px; border-left:3px solid #0277bd; font-size:0.95em;">
                    <span style="color:#999; font-size:0.85em;">[回家] 帰る → お帰りになる</span><br>
                    先生はもう<strong>お帰りになりました</strong>。<br>
                    <span style="color:#666; font-size:0.85em;">(老师已经回去了。)</span>
                </div>
                <div style="background:white; padding:10px; border-radius:6px; border-left:3px solid #0277bd; font-size:0.95em;">
                    <span style="color:#999; font-size:0.85em;">[写] 書く → お書きになる</span><br>
                    この本は先生が<strong>お書きになった</strong>本です。<br>
                    <span style="color:#666; font-size:0.85em;">(这本书是老师写的。)</span>
                </div>
            </div>
        </div>

        <div style="margin-bottom: 25px;">
            <strong style="color:#0277bd; font-size:1.1em;">② 动词被动形 (れる / られる)</strong>
            <span style="background:#29b6f6; color:white; font-size:0.7em; padding:2px 5px; border-radius:3px; vertical-align:middle; margin-left:5px;">最常用/较轻松</span>
            
            <p style="font-size:0.85em; color:#555; margin:5px 0 10px 0;">
                <span style="color:#d84315;">💡 重点：</span> 变形规则和“被动态”完全一样。<br>
                尊敬程度比较前者略低，<strong>日常口语出现频率高</strong>。
            </p>

            <div style="margin-top:10px; display:grid; gap:8px;">
                <div style="background:white; padding:10px; border-radius:6px; border-left:3px solid #29b6f6; font-size:0.95em;">
                    <span style="color:#999; font-size:0.85em;">[读] 読む → 読まれる</span><br>
                    社長は毎朝、新聞を<strong>読まれます</strong>。<br>
                    <span style="color:#666; font-size:0.85em;">(社长每天早上都会读报纸。)</span>
                </div>
                <div style="background:white; padding:10px; border-radius:6px; border-left:3px solid #29b6f6; font-size:0.95em;">
                    <span style="color:#999; font-size:0.85em;">[回来] 帰る → 帰られる</span><br>
                    部長はいつ<strong>帰られます</strong>か。<br>
                    <span style="color:#666; font-size:0.85em;">(部长什么时候回来？)</span>
                </div>
            </div>
        </div>

        <div style="margin-bottom: 25px;">
            <strong style="color:#0277bd; font-size:1.1em;">③ お + <span style="color:#e74c3c;">动词第一连用形</span> + です</strong>
            <span style="background:#4fc3f7; color:white; font-size:0.7em; padding:2px 5px; border-radius:3px; vertical-align:middle; margin-left:5px;">状态描述</span>
            <p style="font-size:0.85em; color:#555; margin:5px 0 5px 0;">表示正在进行或持续拥有的状态。</p>
            
            <div style="margin-top:5px; display:grid; gap:8px;">
                <div style="background:white; padding:10px; border-radius:6px; border-left:3px solid #4fc3f7; font-size:0.95em;">
                    <span style="color:#999; font-size:0.85em;">[持有] 持つ → お持ちです</span><br>
                    チケットは<strong>お持ちですか</strong>。<br>
                    <span style="color:#666; font-size:0.85em;">(您带着票吗？)</span>
                </div>
                <div style="background:white; padding:10px; border-radius:6px; border-left:3px solid #4fc3f7; font-size:0.95em;">
                    <span style="color:#999; font-size:0.85em;">[读] 読む → お読みです</span><br>
                    あの本はもう<strong>お読みですか</strong>。<br>
                    <span style="color:#666; font-size:0.85em;">(那本书您已经在读了吗？)</span>
                </div>
            </div>
        </div>

        <div style="margin-bottom: 0;">
            <strong style="color:#0277bd; font-size:1.1em;">④ (汉语词) + なさる </strong>
            <span style="background:#81d4fa; color:white; font-size:0.7em; padding:2px 5px; border-radius:3px; vertical-align:middle; margin-left:5px;">suru升级版</span>
            
            <div style="margin-top:10px; display:grid; gap:8px;">
                <div style="background:white; padding:10px; border-radius:6px; border-left:3px solid #81d4fa; font-size:0.95em;">
                    <span style="color:#999; font-size:0.85em;">[散步] 散歩する → 散歩なさる</span><br>
                    会長は公園を<strong>散歩なさいます</strong>。<br>
                    <span style="color:#666; font-size:0.85em;">(会长在公园散步。)</span>
                </div>
                <div style="background:white; padding:10px; border-radius:6px; border-left:3px solid #81d4fa; font-size:0.95em;">
                    <span style="color:#999; font-size:0.85em;">[担心] 心配する → 心配なさる</span><br>
                    ご<strong>心配なさらないで</strong>ください。<br>
                    <span style="color:#666; font-size:0.85em;">(请您不要担心。)</span>
                </div>
            </div>
        </div>

    </div>
</div>

<div class="card" style="border-top: 5px solid #ff9800;">
    <div style="border-bottom: 1px solid #eee; margin-bottom: 15px; padding-bottom: 10px;">
        <span style="background:#ff9800; color:white; padding:4px 8px; border-radius:4px; font-size:0.8rem; margin-right:10px;">Step 2</span>
        <strong style="font-size:1.2rem; color:#e65100;">⬇️ 自谦语 (自己做)</strong>
    </div>

    <div style="background:#fff3e0; padding:10px 15px; border-left:4px solid #ff9800; margin-bottom:20px;">
        <strong>定义：</strong> 动作主语是<strong>“我自己”</strong>或<strong>“己方人员”</strong>。<br>
        通过<span style="color:#e65100; font-weight:bold;">压低</span>自己的动作，来衬托对方的高大。<br>
        <span style="font-size:0.85em; color:#bf360c;">💡 注意：必须分清是“为了对方做(I)”还是“自己礼貌地说(II)”。</span>
    </div>
    
    <div style="display: flex; flex-direction: column; gap: 20px;">

        <div style="background: #fff8e1; padding: 15px; border-radius: 8px; border: 1px solid #ffe0b2;">
            <div style="border-bottom: 2px dashed #ffcc80; padding-bottom: 8px; margin-bottom: 10px;">
                <strong style="color: #d84315; font-size: 1.1em;">1. 一类自谦：描述涉及到对方的情况 </strong>
                <span style="background:#ffcc80; color:#5d4037; font-size:0.75em; padding:2px 6px; border-radius:4px; margin-left:8px;">必须有对象</span>
            </div>
            
            <p style="font-size: 0.9em; color: #5d4037; margin-bottom: 10px;">
                <strong>逻辑：</strong> 我的这个动作是<strong>“做给对方看的”</strong>或者<strong>“影响到对方的”</strong>。如果对方不在场，这个动作就不成立。
            </p>

            <div style="background: white; padding: 10px; border-radius: 6px; text-align: center; margin-bottom: 10px; border: 1px solid #ffe0b2;">
                <strong>お / ご + <span style="color:#d84315;">动词第一连用形</span> + する / いたす</strong>
            </div>

            <div style="display: grid; gap: 8px;">
                <div style="background: white; padding: 8px; border-radius: 4px; border-left: 3px solid #d84315; font-size: 0.95em;">
                    <span style="color:#999; font-size:0.85em;">[持有]持つ → お持ちする</span><br>
                    重そうですね、<strong>お持ちします</strong>。<br>
                    <span style="color:#666; font-size:0.85em;">(看起来很重呢，我来帮您拿。 → 动作指向：您)</span>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; border-left: 3px solid #d84315; font-size: 0.95em;">
                    <span style="color:#999; font-size:0.85em;">[联络] 連絡する → ご連絡する</span><br>
                    明日、こちらから<strong>ご連絡します</strong>。<br>
                    <span style="color:#666; font-size:0.85em;">(明天我会主动联系您。 → 动作指向：您)</span>
                </div>
            </div>
        </div>

        <div style="background: #fff3e0; padding: 15px; border-radius: 8px; border: 1px solid #ffe0b2;">
            <div style="border-bottom: 2px dashed #ffb74d; padding-bottom: 8px; margin-bottom: 10px;">
                <strong style="color: #ef6c00; font-size: 1.1em;">2. 二类自谦：描述单纯体现自我谦逊的情况 </strong>
                <span style="background:#ffb74d; color:white; font-size:0.75em; padding:2px 6px; border-radius:4px; margin-left:8px;">无需对象</span>
            </div>

            <p style="font-size: 0.9em; color: #5d4037; margin-bottom: 10px;">
                <strong>逻辑：</strong> 动作不一定影响对方，只是为了<strong>“向听话人展示自己的谦逊”</strong>。哪怕是自我介绍、或者说自己的状态，也可以用。
            </p>

            <div style="background: white; padding: 10px; border-radius: 6px; text-align: center; margin-bottom: 10px; border: 1px solid #ffcc80;">
                <strong>特殊动词 / (汉语词) + いたす</strong>
            </div>

            <div style="display: grid; gap: 8px;">
                <div style="background: white; padding: 8px; border-radius: 4px; border-left: 3px solid #ef6c00; font-size: 0.95em;">
                    <span style="color:#999; font-size:0.85em;">[去/来] 行く/来る → 参る</span><br>
                    電車が<strong>参ります</strong>。<br>
                    <span style="color:#666; font-size:0.85em;">(电车来了。 → 电车并不认识你，但广播员对你表示礼貌。)</span>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; border-left: 3px solid #ef6c00; font-size: 0.95em;">
                    <span style="color:#999; font-size:0.85em;">[名字] 言う → 申す</span><br>
                    田中と<strong>申します</strong>。<br>
                    <span style="color:#666; font-size:0.85em;">(我叫田中。 → 这是我自己的名字，不涉及对方，但对听众表示谦虚。)</span>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; border-left: 3px solid #ef6c00; font-size: 0.95em;">
                    <span style="color:#999; font-size:0.85em;">[做] する → いたす</span><br>
                    私が準備<strong>いたします</strong>。<br>
                    <span style="color:#666; font-size:0.85em;">(我来准备。 → 比“準備します”更郑重。)</span>
                </div>
            </div>
        </div>

    </div>

    <div style="margin-top:15px; padding:10px; background:#fafafa; border:1px dashed #bdbdbd; border-radius:6px; font-size:0.9em; color:#616161;">
        <strong>🚫 常见错误：</strong><br>
        “我明天休息”可以说「明日、休みます」，但<strong>不能</strong>说「お休みします」。<br>
        因为“休息”是你自己的事，没有对象，也没有对应的特殊动词。<br>
        <span style="color:#ef6c00;">正确说法：明日、休ませていただきます (使用使役自谦（见下特殊句式部分）)。</span>
    </div>
</div>

<div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px;">
    <h3 style="margin-top: 0; border-bottom: 1px solid rgba(255,255,255,0.3); padding-bottom: 10px;">
        🛑 重点：优先使用的“特殊词”
    </h3>

    <p style="line-height: 1.6; font-size: 1.05em;">
        刚才我们在 尊他 (蓝色) 和 自谦 (橙色) 中学习了通用的“变形公式”。<br>
        但在日语中，最常用的<strong>“去、来、吃、看、说”</strong>等高频词，<span style="background: #ffeb3b; color: #333; padding: 2px 6px; border-radius: 4px; font-weight: bold;">有着不遵守</span>上面的规则，属于自己独立的“特殊形态”。
    </p>

    <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; margin: 20px 0; border: 1px solid rgba(255,255,255,0.2);">
        <strong style="color: #ffeb3b; font-size: 1.1em;">⚡️ 优先原则</strong>
        <p style="margin: 5px 0 10px 0; font-size: 0.95em; opacity: 0.9;">
            如果一个动词拥有“特殊敬语”形式，<strong>优先使用特殊词</strong>，比较少套用通用公式。
        </p>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            
            <div style="background: rgba(255,255,255,0.95); color: #333; padding: 12px; border-radius: 6px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                <strong style="color: #0056b3; display:block; margin-bottom:5px;">⬆️ 尊他 (对方去)</strong>
                <div style="font-size: 0.9em; color: #666; text-decoration: line-through;">
                    × お行きになります <span style="font-size:0.8em;">(套公式)</span>
                </div>
                <div style="font-size: 1.1em; font-weight: bold; color: #d32f2f; margin-top: 2px;">
                    √ いらっしゃいます <span style="font-size:0.8em; color:#d32f2f;">(特殊词)</span>
                </div>
            </div>

            <div style="background: rgba(255,255,255,0.95); color: #333; padding: 12px; border-radius: 6px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                <strong style="color: #e65100; display:block; margin-bottom:5px;">⬇️ 自谦 (我去)</strong>
                <div style="font-size: 0.9em; color: #666; text-decoration: line-through;">
                    × お行きします <span style="font-size:0.8em;">(套公式)</span>
                </div>
                <div style="font-size: 1.1em; font-weight: bold; color: #d32f2f; margin-top: 2px;">
                    √ 参ります <span style="font-size:0.8em; color:#d32f2f;">(特殊词)</span>
                </div>
            </div>

        </div>
    </div>

    <p style="font-size: 0.95em; opacity: 0.9;">
        这些词虽然数量不多，但占据了日常对话的 80%。请点击下方按钮，进入专门的表格进行记忆。
    </p>

    <button onclick="switchMainTab('special')" style="
        background: white; 
        color: #764ba2; 
        border: none; 
        padding: 12px 30px; 
        border-radius: 30px; 
        font-weight: bold; 
        cursor: pointer; 
        margin-top: 10px;
        font-size: 1rem;
        box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        transition: transform 0.2s;
        display: block;
        width: 100%;
        max-width: 300px;
        margin-left: auto;
        margin-right: auto;
    " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
        🚀 明白了，去背《特殊敬语表》
    </button>
</div>
        <div class="card" style="border-top: 5px solid #2ecc71;">
    <div style="border-bottom: 1px solid #eee; margin-bottom: 20px; padding-bottom: 15px;">
        <span style="background:#2ecc71; color:white; padding:6px 10px; border-radius:4px; font-size:0.85rem; margin-right:10px;">Step 3</span>
        <strong style="font-size:1.3rem; color:#27ae60;">特定句式表达</strong>
    </div>

    <div style="background:#e8f8f5; padding:15px 20px; border-left:5px solid #2ecc71; margin-bottom:30px; border-radius: 4px;">
        <strong style="font-size:1.05em;">定义：</strong><br>
        <p style="margin: 5px 0 0 0; color:#333; line-height: 1.6;">
            除上述的基础动词变形外，日语中存在一系列<strong>固定的句式结构</strong>。<br>
            这些句式通过组合“使役”、“授受”或“特定补助动词”，来实现更高级别的自谦或尊他功能。
        </p>
    </div>

    <div style="display: flex; flex-direction: column; gap: 35px;">

        <div style="background: #fff3e0; padding: 20px; border-radius: 10px; border: 1px solid #ffcc80;">
            <div style="border-bottom: 1px dashed #ffa726; padding-bottom: 10px; margin-bottom: 15px;">
                <strong style="color: #e65100; font-size: 1.15em;">1. 描述自身行为 (郑重陈述)</strong>
                <span style="background:#ffcc80; color:#fff; font-size:0.75em; padding:3px 8px; border-radius:4px; margin-left:8px; vertical-align: text-bottom;">自谦</span>
            </div>
            
            <p style="font-size:0.95em; margin-bottom:15px; color:#5d4037; line-height: 1.5;">
                当说话人向听话人陈述自己的情感、或某种自我行为时，使用「申し上げます」替代普通的「します/言います」，以表达郑重的语气。
            </p>

            <div style="background:white; padding:15px; border-radius:6px; border-left:4px solid #ff9800; box-shadow: 0 2px 4px rgba(0,0,0,0.02);">
                <strong style="font-size: 1.05em; color: #333;">お/ご + 名词 + 申し上げます</strong>
                <div style="margin-top:10px; padding-top:10px; border-top:1px dashed #eee;">
                    <div style="margin-bottom:8px;">
                        例：心より<strong>お詫び申し上げます</strong>。<br>
                        <span style="color:#999; font-size:0.85em;">(由衷地表示歉意。)</span>
                    </div>
                    <div>
                        例：厚く<strong>お礼申し上げます</strong>。<br>
                        <span style="color:#999; font-size:0.85em;">(致以深切的谢意。)</span>
                    </div>
                </div>
            </div>
        </div>

        <div style="background: #f9fbe7; padding: 20px; border-radius: 10px; border: 1px solid #dce775;">
            <div style="border-bottom: 1px dashed #c0ca33; padding-bottom: 10px; margin-bottom: 15px;">
                <strong style="color: #827717; font-size: 1.15em;">2. 请求允许自身行为 (使役自谦)</strong>
                <span style="background:#dce775; color:#555; font-size:0.75em; padding:3px 8px; border-radius:4px; margin-left:8px; vertical-align: text-bottom;">自谦</span>
            </div>
            
            <p style="font-size:0.95em; margin-bottom:15px; color:#555; line-height: 1.5;">
                通过使用“使役态 (让...)”与“授受动词 (我领受...)”的组合，表达“请允许我做某事”的含义。这是商务日语中陈述自己动作的标准形式。
            </p>

            <div style="background:white; padding:15px; border-radius:6px; border-left:4px solid #2ecc71; margin-bottom:15px; box-shadow: 0 2px 4px rgba(0,0,0,0.02);">
                <strong style="font-size: 1.05em; color: #333;">(さ)せて + いただけませんか</strong>
                <span style="font-size:0.85em; color:#999; margin-left:8px;">(询问对方是否允许)</span>
                <div style="margin-top:8px; color:#333; font-size: 0.95em;">
                    例：本日、早退<strong>させていただけませんか</strong>。<br>
                    <span style="font-size:0.85em; color:#888;">(今天能允许我早退吗？)</span>
                </div>
            </div>

            <div style="background:white; padding:15px; border-radius:6px; border-left:4px solid #a5d6a7; box-shadow: 0 2px 4px rgba(0,0,0,0.02);">
                <strong style="font-size: 1.05em; color: #333;">(さ)せて + いただきます</strong>
                <span style="font-size:0.85em; color:#999; margin-left:8px;">(宣告自己将做某事)</span>
                <div style="margin-top:8px; color:#333; font-size: 0.95em;">
                    例：説明<strong>させていただきます</strong>。<br>
                    <span style="font-size:0.85em; color:#888;">(那么，请允许我说明一下。)</span>
                </div>
            </div>
        </div>

        <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; border: 1px solid #90caf9;">
            <div style="border-bottom: 1px dashed #42a5f5; padding-bottom: 10px; margin-bottom: 15px;">
                <strong style="color: #0d47a1; font-size: 1.15em;">3. 描述他人行为 (书面语中顿)</strong>
                <span style="background:#90caf9; color:#fff; font-size:0.75em; padding:3px 8px; border-radius:4px; margin-left:8px; vertical-align: text-bottom;">尊他</span>
            </div>
            
            <p style="font-size:0.95em; margin-bottom:15px; color:#555; line-height: 1.5;">
                在正式场景中，当需要连接两个句子并描述对方的行为时，常通过以下的特定形式来体现尊他语态。
            </p>

            <div style="margin-bottom: 15px; background:white; padding:15px; border-radius:6px; border-left:4px solid #2196f3; box-shadow: 0 2px 4px rgba(0,0,0,0.02);">
                <strong style="font-size: 1.05em; color: #333;">お/ご + (动词第一连用) + いただき、...</strong>
                <div style="font-size:0.95em; margin-top:8px; color:#333;">
                    <span style="background:#e3f2fd; color:#1565c0; font-size:0.8em; padding:2px 6px; border-radius:3px;">含义</span> 承蒙您...(做某事)，我方获益。<br>
                    <div style="margin-top:5px;">
                        例：<strong>ご</strong>検討<strong>いただき</strong>、ありがとうございます。<br>
                        <span style="font-size:0.85em; color:#888;">(承蒙您探讨，非常感谢。)</span>
                    </div>
                </div>
            </div>

            <div style="background:white; padding:15px; border-radius:6px; border-left:4px solid #2196f3; box-shadow: 0 2px 4px rgba(0,0,0,0.02);">
                <strong style="font-size: 1.05em; color: #333;">お/ご + (动词第一连用) + くださり、...</strong>
                <div style="font-size:0.95em; margin-top:8px; color:#333;">
                    <span style="background:#e3f2fd; color:#1565c0; font-size:0.8em; padding:2px 6px; border-radius:3px;">含义</span> 您特意...(做某事)，我方感激。<br>
                    <div style="margin-top:5px;">
                        例：遠方より<strong>お</strong>越し<strong>くださり</strong>、感謝いたします。<br>
                        <span style="font-size:0.85em; color:#888;">(您特意远道而来，不胜感激。)</span>
                    </div>
                </div>
            </div>
        </div>

        <div style="background: #e8f8f5; padding: 20px; border-radius: 10px; border: 1px solid #b2dfdb;">
            <div style="border-bottom: 1px dashed #4db6ac; padding-bottom: 10px; margin-bottom: 15px;">
                <strong style="color: #00695c; font-size: 1.15em;">4. 请求他人行为 (委托请求)</strong>
                <span style="background:#b2dfdb; color:#555; font-size:0.75em; padding:3px 8px; border-radius:4px; margin-left:8px; vertical-align: text-bottom;">尊他</span>
            </div>

            <p style="font-size:0.95em; margin-bottom:15px; color:#555; line-height: 1.5;">
                根据“强制性”与“委婉度”的不同，请求对方做某事主要有以下四种形式。
            </p>

            <div style="background:white; padding:15px; border-radius:6px; border-left:4px solid #4db6ac; margin-bottom:15px; box-shadow: 0 2px 4px rgba(0,0,0,0.02);">
                <strong style="font-size: 1.05em; color: #333;">お/ご～ください</strong>
                <span style="font-size:0.85em; color:#999; margin-left:8px;">(指示/命令)</span>
                <div style="font-size:0.95em; margin-top:8px; color:#333;">
                    例：少々<strong>お待ちください</strong>。<br>
                    <span style="font-size:0.85em; color:#888;">(请稍等。)</span>
                </div>
            </div>

            <div style="background:white; padding:15px; border-radius:6px; border-left:4px solid #4db6ac; margin-bottom:15px; box-shadow: 0 2px 4px rgba(0,0,0,0.02);">
                <strong style="font-size: 1.05em; color: #333;">お/ご～願います</strong>
                <span style="font-size:0.85em; color:#999; margin-left:8px;">(愿望/公文)</span>
                <div style="font-size:0.95em; margin-top:8px; color:#333;">
                    例：ご協力<strong>お願いします</strong>。<br>
                    <span style="font-size:0.85em; color:#888;">(希请协助。)</span>
                </div>
            </div>

            <div style="background:white; padding:15px; border-radius:6px; border-left:4px solid #009688; margin-bottom:15px; box-shadow: 0 2px 4px rgba(0,0,0,0.02);">
                <strong style="font-size: 1.05em; color: #333;">お/ご～いただけませんか</strong>
                <span style="font-size:0.85em; color:#999; margin-left:8px;">(商量/询问)</span>
                <div style="font-size:0.95em; margin-top:8px; color:#333;">
                    例：ご確認<strong>いただけませんか</strong>。<br>
                    <span style="font-size:0.85em; color:#888;">(能麻烦您确认一下吗？)</span>
                </div>
            </div>

            <div style="background:white; padding:15px; border-radius:6px; border-left:4px solid #009688; box-shadow: 0 2px 4px rgba(0,0,0,0.02);">
                <strong style="font-size: 1.05em; color: #333;">～ば / ～たら + と思います</strong>
                <span style="font-size:0.85em; color:#999; margin-left:8px;">(期望/建议)</span>
                
                <div style="margin-top:8px; font-size:0.95em; color:#555; line-height: 1.5;">
                    <span style="color:#00796b; font-weight:bold;">敬语版：</span> <strong>お/ご～いただければ + と思います</strong><br>
                    <span style="font-size:0.9em; opacity:0.8;">(如果不直接要求，而是说“如果您能...我就觉得太好了”)</span>
                    
                    <div style="margin-top:8px; padding-top:8px; border-top:1px dashed #eee;">
                        例：ご検討<strong>いただければと思います</strong>。<br>
                        <span style="font-size:0.85em; color:#888;">(希望能劳烦您讨论一下。—— *最不强求、最柔和的说法*)</span>
                    </div>
                </div>
            </div>

        </div>

    </div>
</div>
           </div>

           <div id="special" class="panel">
        
        <div class="card" style="border-top: 4px solid #9c27b0; padding: 25px;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:1px solid #eee; padding-bottom:10px;">
                <h2 style="margin:0; color:#333;">常用特殊敬语对照表</h2>
                <span style="font-size:0.85em; color:#999; background:#f3e5f5; color:#7b1fa2; padding:4px 10px; border-radius:15px; font-weight:bold;">N1/N2 核心考点</span>
            </div>

            <p style="font-size:0.9em; color:#666; margin-bottom:20px; background:#fafafa; padding:10px; border-radius:6px;">
                <span style="color:#d81b60; font-weight:bold;">注：</span> 表格中标记为 <span style="color:#ccc;">—</span> 的项，表示无专用特殊词，请使用通用公式（如 <ruby>お<rt></rt></ruby>〜になる）。
            </p>

            <style>
                .honorific-table {
                    width: 100%;
                    border-collapse: separate; 
                    border-spacing: 0;
                    border: 1px solid #e0e0e0;
                    border-radius: 8px;
                    overflow: hidden;
                    font-size: 1rem;
                }
                .honorific-table th {
                    background: #f3e5f5;
                    color: #4a148c;
                    padding: 15px 10px;
                    text-align: left;
                    font-weight: bold;
                    border-bottom: 2px solid #e1bee7;
                }
                .honorific-table td {
                    padding: 12px 10px;
                    border-bottom: 1px solid #eee;
                    vertical-align: middle;
                    line-height: 1.6;
                }
                .col-sonkeigo { background-color: #f0f7ff; color: #0d47a1; }
                .col-kenjougo { background-color: #fff8e1; color: #e65100; }
                
                .word-item { 
                    font-weight: bold; 
                    font-size: 1.05em; 
                    display: block; 
                    margin-bottom: 4px;
                }
                ruby { font-weight: inherit; }
                rt { font-weight: normal; font-size: 0.6em; color: #888; } 
                .note { font-weight: normal; font-size: 0.8em; color: #666; margin-left: 2px; }
            </style>

            <table class="honorific-table">
                <thead>
                    <tr>
                        <th style="width:12%;">原形</th>
                        <th style="width:12%;">含义</th>
                        <th style="width:38%; background:#e3f2fd; color:#1565c0;">⬆️ 尊他语 (对方)</th>
                        <th style="width:38%; background:#fff3e0; color:#ef6c00;">⬇️ 自谦语 (自己)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="background:#fafafa;"><td colspan="4" style="padding:8px 15px; color:#9c27b0; font-weight:bold; font-size:0.85em; border-bottom:1px solid #eee;">1. 存在与移动</td></tr>
                    
                    <tr>
                        <td><span class="word-item"><ruby>行<rt>い</rt></ruby>く</span></td>
                        <td style="color:#666; font-size:0.9em;">去<br>
                        <td class="col-sonkeigo">
                            <span class="word-item">いらっしゃる</span>
                            <span class="word-item"><ruby>お<rt></rt></ruby>いでになる</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>参<rt>まい</rt></ruby>る</span>
                            <span class="word-item"><ruby>伺<rt>うかが</rt></ruby>う <span class="note">(拜访)</span></span>
                            <span class="word-item">あがる <span class="note">(上门)</span></span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item"><ruby>来<rt>く</rt></ruby>る</span></td>
                        <td style="color:#666;">来</td>
                        <td class="col-sonkeigo">
                            <span class="word-item">いらっしゃる</span>
                            <span class="word-item"><ruby>お<rt></rt></ruby>いでになる</span>
                            <span class="word-item"><ruby>お<rt></rt></ruby><ruby>越<rt>こ</rt></ruby>しになる</span>
                            <span class="word-item"><ruby>見<rt>み</rt></ruby>える</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>参<rt>まい</rt></ruby>る</span>
                            <span class="word-item"><ruby>伺<rt>うかが</rt></ruby>う <span class="note">(拜访)</span></span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item">いる</span></td>
                        <td style="color:#666;">在</td>
                        <td class="col-sonkeigo">
                            <span class="word-item">いらっしゃる</span>
                            <span class="word-item"><ruby>お<rt></rt></ruby>いでになる</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item">おる</span>
                        </td>
                    </tr>

                    <tr style="background:#fafafa;"><td colspan="4" style="padding:8px 15px; color:#9c27b0; font-weight:bold; font-size:0.85em; border-bottom:1px solid #eee;">2. 日常言行</td></tr>

                    <tr>
                        <td><span class="word-item">する</span></td>
                        <td style="color:#666;">做</td>
                        <td class="col-sonkeigo">
                            <span class="word-item">なさる</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item">いたす</span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item"><ruby>言<rt>い</rt></ruby>う</span></td>
                        <td style="color:#666;">说</td>
                        <td class="col-sonkeigo">
                            <span class="word-item">おっしゃる</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>申<rt>もう</rt></ruby>す <span class="note">(自己发言)</span></span>
                            <span class="word-item"><ruby>申<rt>もう</rt></ruby>し<ruby>上<rt>あ</rt></ruby>げる <span class="note">(向您汇报)</span></span>
                        </td>
                    </tr>
                    
                    <tr>
                        <td><span class="word-item"><ruby>伝<rt>つた</rt></ruby>える</span></td>
                        <td style="color:#666;">传达</td>
                        <td class="col-sonkeigo">
                            <span style="color:#ccc;">—</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>申<rt>もう</rt></ruby>し<ruby>伝<rt>つた</rt></ruby>える <span class="note">(代转达)</span></span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item"><ruby>食<rt>た</rt></ruby>べる</span></td>
                        <td style="color:#666;">吃/喝</td>
                        <td class="col-sonkeigo">
                            <span class="word-item"><ruby>召<rt>め</rt></ruby>し<ruby>上<rt>あ</rt></ruby>がる</span>
                            <span class="word-item">あがる <span class="note">(喝茶)</span></span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item">いただく</span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item"><ruby>見<rt>み</rt></ruby>る</span></td>
                        <td style="color:#666;">看</td>
                        <td class="col-sonkeigo">
                            <span class="word-item"><ruby>ご<rt></rt></ruby><ruby>覧<rt>らん</rt></ruby>になる</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>拝<rt>はい</rt></ruby><ruby>見<rt>けん</rt></ruby>する</span>
                        </td>
                    </tr>
　　　　　　　　　　　　<tr>
                        <td><span class="word-item"><ruby>見<rt>み</rt></ruby>せる</span></td>
                        <td style="color:#666;">展示</td>
                        <td class="col-sonkeigo">
                            <span style="color:#ccc;">—</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>お<rt></rt></ruby><ruby>目<rt>め</rt></ruby>に<ruby>掛<rt>か</rt></ruby>ける <span class="note">(让您过目)</span></span>
                            <span class="word-item"><ruby>ご<rt></rt></ruby><ruby>覧<rt>らん</rt></ruby>に<ruby>入<rt>い</rt></ruby>れる <span class="note">(恭敬呈阅)</span></span>
                        </td>
                    </tr>
                    <tr>
                        <td><span class="word-item"><ruby>知<rt>し</rt></ruby>る</span></td>
                        <td style="color:#666;">知道</td>
                        <td class="col-sonkeigo">
                            <span class="word-item"><ruby>ご<rt></rt></ruby><ruby>存<rt>ぞん</rt></ruby>じだ</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>存<rt>ぞん</rt></ruby>じる</span>
                            <span class="word-item"><ruby>存<rt>ぞん</rt></ruby>じ<ruby>上<rt>あ</rt></ruby>げる <span class="note">(认识人)</span></span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item"><ruby>着<rt>き</rt></ruby>る</span></td>
                        <td style="color:#666;">穿</td>
                        <td class="col-sonkeigo">
                            <span class="word-item"><ruby>お<rt></rt></ruby><ruby>召<rt>め</rt></ruby>しになる</span>
                        </td>
                        <td class="col-kenjougo">
                            <span style="color:#ccc;">—</span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item"><ruby>寝<rt>ね</rt></ruby>る</span></td>
                        <td style="color:#666;">睡觉</td>
                        <td class="col-sonkeigo">
                            <span class="word-item"><ruby>お<rt></rt></ruby><ruby>休<rt>やす</rt></ruby>みになる</span>
                        </td>
                        <td class="col-kenjougo">
                            <span style="color:#ccc;">—</span>
                        </td>
                    </tr>

                    <tr style="background:#fafafa;"><td colspan="4" style="padding:8px 15px; color:#9c27b0; font-weight:bold; font-size:0.85em; border-bottom:1px solid #eee;">3. 社交互动 (授受/访问)</td></tr>

                    <tr>
                        <td><span class="word-item"><ruby>受<rt>う</rt></ruby>ける</span></td>
                        <td style="color:#666;">接受</td>
                        <td class="col-sonkeigo">
                            <span style="color:#ccc;">—</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>承<rt>うけたまわ</rt></ruby>る</span>
                            <span class="word-item"><ruby>拝<rt>はい</rt></ruby><ruby>受<rt>じゅ</rt></ruby>する</span>
                        </td>
                    </tr>
                    
                    <tr>
                        <td><span class="word-item"><ruby>受<rt>う</rt></ruby>け<ruby>取<rt>と</rt></ruby>る</span></td>
                        <td style="color:#666;">收下</td>
                        <td class="col-sonkeigo">
                            <span style="color:#ccc;">—</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>賜<rt>たまわ</rt></ruby>る <span class="note">(蒙赐)</span></span>
                            <span class="word-item"><ruby>頂<rt>ちょう</rt></ruby><ruby>戴<rt>だい</rt></ruby>する</span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item"><ruby>聞<rt>き</rt></ruby>く</span></td>
                        <td style="color:#666;">听/问</td>
                        <td class="col-sonkeigo">
                            <span style="color:#ccc;">—</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>伺<rt>うかが</rt></ruby>う</span>
                            <span class="word-item"><ruby>拝<rt>はい</rt></ruby><ruby>聴<rt>ちょう</rt></ruby>する <span class="note">(听)</span></span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item"><ruby>訪<rt>たず</rt></ruby>ねる</span></td>
                        <td style="color:#666;">访问</td>
                        <td class="col-sonkeigo">
                            <span style="color:#ccc;">—</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>伺<rt>うかが</rt></ruby>う</span>
                            <span class="word-item">あがる <span class="note">(上门)</span></span>
                            <span class="word-item"><ruby>お<rt></rt></ruby><ruby>邪<rt>じゃ</rt></ruby><ruby>魔<rt>ま</rt></ruby>する</span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item"><ruby>会<rt>あ</rt></ruby>う</span></td>
                        <td style="color:#666;">见面</td>
                        <td class="col-sonkeigo">
                            <span style="color:#ccc;">—</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>お<rt></rt></ruby><ruby>目<rt>め</rt></ruby>にかかる</span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item"><ruby>見<rt>み</rt></ruby>せる</span></td>
                        <td style="color:#666;">展示</td>
                        <td class="col-sonkeigo">
                            <span style="color:#ccc;">—</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>お<rt></rt></ruby><ruby>目<rt>め</rt></ruby>に<ruby>掛<rt>か</rt></ruby>ける</span>
                            <span class="word-item"><ruby>ご<rt></rt></ruby><ruby>覧<rt>らん</rt></ruby>に<ruby>入<rt>い</rt></ruby>れる</span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item"><ruby>与<rt>あた</rt></ruby>える</span></td>
                        <td style="color:#666;">给予</td>
                        <td class="col-sonkeigo">
                            <span class="word-item"><ruby>くだ<rt></rt></ruby>さる</span>
                            <span class="word-item"><ruby>賜<rt>たまわ</rt></ruby>る <span class="note">(赏赐)</span></span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>差<rt>さ</rt></ruby>し<ruby>上<rt>あ</rt></ruby>げる</span>
                        </td>
                    </tr>
                    
                    <tr>
                        <td><span class="word-item">あげる</span></td>
                        <td style="color:#666;">给</td>
                        <td class="col-sonkeigo">
                            <span style="color:#ccc;">—</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>差<rt>さ</rt></ruby>し<ruby>上<rt>あ</rt></ruby>げる</span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item">くれる</span></td>
                        <td style="color:#666;">(给我)</td>
                        <td class="col-sonkeigo">
                            <span class="word-item">くださる</span>
                            <span class="word-item"><ruby>賜<rt>たまわ</rt></ruby>る <span class="note">(赏赐)</span></span>
                        </td>
                        <td class="col-kenjougo">
                            <span style="color:#ccc;">—</span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item">もらう</span></td>
                        <td style="color:#666;">领受</td>
                        <td class="col-sonkeigo">
                            <span style="color:#ccc;">—</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item">いただく</span>
                            <span class="word-item"><ruby>頂<rt>ちょう</rt></ruby><ruby>戴<rt>だい</rt></ruby>する</span>
                            <span class="word-item"><ruby>賜<rt>たまわ</rt></ruby>る <span class="note">(蒙赐)</span></span>
                        </td>
                    </tr>
                    
                    <tr>
                        <td><span class="word-item"><ruby>借<rt>か</rt></ruby>りる</span></td>
                        <td style="color:#666;">借入</td>
                        <td class="col-sonkeigo">
                            <span style="color:#ccc;">—</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>拝<rt>はい</rt></ruby><ruby>借<rt>しゃく</rt></ruby>する</span>
                        </td>
                    </tr>

                    <tr style="background:#fafafa;"><td colspan="4" style="padding:8px 15px; color:#9c27b0; font-weight:bold; font-size:0.85em; border-bottom:1px solid #eee;">4. 思考与情感</td></tr>

                    <tr>
                        <td><span class="word-item"><ruby>思<rt>おも</rt></ruby>う</span></td>
                        <td style="color:#666;">想</td>
                        <td class="col-sonkeigo">
                            <span class="word-item"><ruby>思<rt>おぼ</rt></ruby>し<ruby>召<rt>め</rt></ruby>す <span class="note">(古雅，较少用)</span></span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>存<rt>ぞん</rt></ruby>じる</span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item"><ruby>考<rt>かんが</rt></ruby>える</span></td>
                        <td style="color:#666;">考虑</td>
                        <td class="col-sonkeigo">
                            <span style="color:#ccc;">—</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item"><ruby>拝<rt>はい</rt></ruby><ruby>察<rt>さつ</rt></ruby>する <span class="note">(推察)</span></span>
                        </td>
                    </tr>

                    <tr>
                        <td><span class="word-item">わかる</span></td>
                        <td style="color:#666;">明白</td>
                        <td class="col-sonkeigo">
                            <span class="word-item"><ruby>ご<rt></rt></ruby><ruby>理<rt>り</rt></ruby><ruby>解<rt>かい</rt></ruby>いただく</span>
                        </td>
                        <td class="col-kenjougo">
                            <span class="word-item">かしこまる <span class="note">(遵命)</span></span>
                            <span class="word-item"><ruby>承<rt>しょう</rt></ruby><ruby>知<rt>ち</rt></ruby>する</span>
                            <span class="word-item"><ruby>了<rt>りょう</rt></ruby><ruby>承<rt>しょう</rt></ruby>する</span>
                        </td>
                    </tr>

                </tbody>
            </table>

            <button class="switch-btn" onclick="switchMainTab('practice')" style="width:100%; margin-top:30px; border:2px solid var(--primary); color:var(--primary); padding:15px; font-size:1rem; background:white; font-weight:bold;">
                记住了？去【分层练习】测试一下 ➜
            </button>
        </div>
    </div>
            </div>

            <div id="practice" class="panel">
                
                <div class="card practice-controls">
                    <div style="display: flex; justify-content: space-between; width: 100%; align-items: center; flex-wrap: wrap; gap: 10px;">
                        
                        <div class="practice-switcher" style="margin: 0; gap: 8px;">
                            <button id="btn-part1" class="switch-btn active" onclick="switchPracticeMode('part1')">基础辨析</button>
                            <button id="btn-part2" class="switch-btn" onclick="switchPracticeMode('part2')">语境实战</button>
                        </div>
                        
                        <div style="display: flex; gap: 10px;">
                            <button id="btn-mistake" onclick="toggleMistakeView()" style="background: white; border: 1px solid #ff7043; color: #ff7043; padding: 6px 15px; border-radius: 15px; font-size: 0.85rem; cursor: pointer; display: flex; align-items: center; gap: 4px;">
                                📖 错题 (<span id="mistake-count">0</span>)
                            </button>

                            <button onclick="resetGame()" style="background: #f5f5f5; border: 1px solid #ccc; color: #666; padding: 6px 12px; border-radius: 15px; font-size: 0.85rem; cursor: pointer;">
                                ↻ 重置
                            </button>
                        </div>
                    </div>

                    <div id="combo-display" style="font-weight: bold; color: #ff7043; opacity: 0; transition: opacity 0.3s; font-size: 1.1rem; padding: 5px 15px; background: #fff3e0; border-radius: 20px;">
                        🔥 连对 <span id="combo-count">0</span> 题
                    </div>
                </div>

        <div id="part1" class="quiz-section active">
            <div id="quiz-container-1"></div>
            <div class="next-btn-wrapper" style="text-align:center; display:none; margin-top:15px;">
                <button onclick="nextQuestion('part1')" class="next-btn">下一题 ➜</button>
            </div>
        </div>

        <div id="part2" class="quiz-section">
            <div id="quiz-container-2"></div>
            <div class="next-btn-wrapper" style="text-align:center; display:none; margin-top:15px;">
                <button onclick="nextQuestion('part2')" class="next-btn">下一题 ➜</button>
            </div>
        </div>
        <div id="mistake-section" style="display: none;">
                    <div style="text-align: center; margin-bottom: 20px; color: #666;">
                        <h3>💔 本次错题回顾</h3>
                        <p style="font-size: 0.9em;">(点击“重置”可清空记录)</p>
                    </div>
                    <div id="mistake-container">
                        </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button onclick="toggleMistakeView()" class="next-btn" style="background: #666;">⬅ 返回练习</button>
                    </div>
                </div>
        <style>
            .next-btn {
                background: var(--primary); color: white; border: none; padding: 12px 40px; border-radius: 25px;
                font-weight: bold; cursor: pointer; box-shadow: 0 4px 10px rgba(92, 107, 192, 0.4);
                font-size: 1rem; transition: transform 0.2s;
            }
            .next-btn:active { transform: scale(0.95); }
        </style>

            </div>
</div> </div></div>

    <script>
        // --- 1. 题库数据 (保持不变) ---
        const bankPart1 = [
            // 原有题目
            { type: "属性判断", q: "单词「拝見する」属于哪种敬语？", options: ["尊敬语 (描述对方)", "自谦语 (描述自己)"], answer: 1, explain: "‘拝见’意为‘拜读/拜看’，是‘見る’的自谦语。" },
            { type: "原形还原", q: "「おっしゃる」对应的动词原形是？", options: ["食べる", "言う", "する", "知る"], answer: 1, explain: "意为‘您说’，是「言う」的尊敬语。" },
            { type: "属性判断", q: "单词「いらっしゃる」属于哪种敬语？", options: ["尊敬语 (对方去/来/在)", "自谦语 (我去/来/在)"], answer: 0, explain: "是「去/来/在」的最高级尊敬语。" },
            
            // --- 新增题目 ---
            { type: "原形还原", q: "自谦语「承る (uketamawaru)」的原形是？", options: ["受ける / 聞く", "会う / 見る", "与える / くれる", "訪ねる"], answer: 0, explain: "意为‘恭敬地接受’或‘恭敬地听’。" },
            { type: "易混淆词", q: "「お目にかける」是什么意思？", options: ["拜见 (自谦：见)", "给您看 (自谦：展示)", "您看 (尊他：看)"], answer: 1, explain: "🚨 陷阱题！<br>お目にかかる = 见 (会う的自谦)<br>お目にかける = 给您看 (見せる的自谦)。" },
            { type: "属性判断", q: "「ご覧に入れる」属于哪种敬语？", options: ["尊敬语 (请您看)", "自谦语 (给您看)"], answer: 1, explain: "这是「見せる (给...看)」的最高级自谦语，意为‘呈给您过目’。" },
            { type: "特殊变形", q: "「知っている」的自谦语是？", options: ["存じております", "ご存じです", "承知します"], answer: 0, explain: "「ご存じ」是尊他；「承知」是明白；知道的自谦是「存じる」。" },
            { type: "原形还原", q: "「なさる」对应的动词原形是？", options: ["なる", "する", "寝る", "直す"], answer: 1, explain: "「なさる」是「する (做)」的尊敬语。" },
            { type: "属性判断", q: "单词「お見えになる」属于哪种敬语？", options: ["尊敬语 (您来了)", "自谦语 (我看见了)", "美化语 (看见)"], answer: 0, explain: "这是「来る」的尊敬语，常用于接待场景，如「田中様がお見えになりました」。" },
            { type: "特殊变形", q: "「利用する」的正确尊敬语是？", options: ["ご利用します", "ご利用なさる", "ご入用です"], answer: 1, explain: "汉语词+なさる。A是错误的套用（自谦句式），C是需要的意思。" },
            { type: "易混淆词", q: "「申す」和「申し上げる」的区别？", options: ["前者对长辈说，后者对平辈说", "前者是自报家门，后者是向对方汇报"], answer: 1, explain: "「申す」不针对特定对象(如自我介绍)；「申し上げる」有明确的接受者(如向您道谢)。" },
            { type: "原形还原", q: "「頂戴 (choudai) する」的原形是？", options: ["食べる", "もらう", "あげる", "買う"], answer: 1, explain: "意为‘领受’，是「もらう」的自谦语 (也有吃喝的意思，但最核心是领受)。" },
            { type: "属性判断", q: "「お越しになる」属于哪种敬语？", options: ["尊敬语 (您来)", "自谦语 (我去)", "郑重语 (去)"], answer: 0, explain: "是「来る」的尊敬语，比「来られます」更正式。" }
        ];

        // --- Part 2: 语境实战 (场景模拟) ---
        const bankPart2 = [
            // 原有题目
            { tag: "场景：请客", q: "请客人喝茶时，你应该说：<br>「どうぞ、_____。」", options: ["いただいてください", "召し上がってください", "飲んでください"], answer: 1, explain: "「召し上がる」是喝的尊敬语。" },
            { tag: "场景：自介", q: "商务会议上介绍自己：<br>「初めまして、鈴木と_____。」", options: ["おっしゃいます", "申します", "言います"], answer: 1, explain: "自报家门用自谦语「申す」。" },
            
            // --- 新增题目 ---
            { tag: "场景：电话", q: "接听公司电话，对方找田中（你上司），但田中不在：<br>「あいにく田中は_____。」", options: ["いらっしゃいません", "席を外しております", "おられません"], answer: 1, explain: "对外部人员提到自己公司的人（哪怕是上司），要用自谦！<br>❌いらっしゃる (尊他)<br>✅おる (自谦)" },
            { tag: "场景：拜访", q: "进入客户办公室时，你应该说：<br>「本日はお忙しいところ、_____。」", options: ["参りました", "伺いました", "お邪魔いたします"], answer: 2, explain: "进门打扰时的惯用语，「お邪魔します」的更郑重版。" },
            { tag: "场景：借物", q: "想跟上司借用一下笔：<br>「ペンを_____よろしいでしょうか。」", options: ["拝借しても", "お借りになっても", "貸していただいても"], answer: 0, explain: "借入 (借りる) 的自谦语是「拝借 (haishaku)」。" },
            { tag: "场景：送别", q: "送客户到电梯口，告别时说：<br>「本日は_____、ありがとうございました。」", options: ["参っていただき", "お越しくださり", "行かれて"], answer: 1, explain: "感谢对方特意“来”，用「来る」的尊他语「お越し」+「くださり (给)」。" },
            { tag: "场景：查看", q: "上司问你看了邮件没，你回答看了：<br>「はい、_____。」", options: ["拝見しました", "ご覧になりました", "見ました"], answer: 0, explain: "看 (見る) 的自谦语是「拝見する」。" },
            { tag: "场景：询问", q: "想问老师的名字，最礼貌的说法：<br>「お名前を_____よろしいでしょうか。」", options: ["伺っても", "申しても", "お聞きしても"], answer: 0, explain: "问/听 (聞く) 的自谦语是「伺う」。" },
            { tag: "场景：传话", q: "替同事传话给客户：<br>「担当の佐藤が、そう_____。」", options: ["おっしゃっていました", "申しておりました", "言っていました"], answer: 1, explain: "向外人转述自己人的话，用自谦语「申す」。" },
            { tag: "场景：应答", q: "上司指示工作后，你表示“明白了/遵命”：<br>「_____。」", options: ["わかりました", "了解しました", "かしこまりました"], answer: 2, explain: "面对长辈/客户，最得体的“明白”是「かしこまりました」或「承知いたしました」。" },
            { tag: "场景：状态", q: "询问客户是否持有会员卡：<br>「会員カードは_____か。」", options: ["持っています", "お持ちします", "お持ちです"], answer: 2, explain: "状态尊他：お + 连用形 + です。B是自谦（我帮您拿）。" },
            { tag: "场景：给予", q: "教授送了你一本书，你告诉朋友：<br>「先生に本を_____。」", options: ["あげた", "くださった", "いただいた"], answer: 2, explain: "我从长辈那里领受，用「いただく」。<br>如果是「先生が...」做主语，才用「くださった」。" }
        ];

        // --- 2. 游戏引擎 ---
        let gameState = {
            part1: { pool: [], currentData: null },
            part2: { pool: [], currentData: null },
            combo: 0,
            mistakes: [] // 新增：错题数组
        };

        window.onload = function() {
            initPool('part1'); initPool('part2');
            nextQuestion('part1'); nextQuestion('part2');
            switchMainTab('basic');
        };

        function initPool(partId) {
            const bank = partId === 'part1' ? bankPart1 : bankPart2;
            gameState[partId].pool = Array.from({length: bank.length}, (_, i) => i);
        }

        function nextQuestion(partId) {
            document.querySelector(`#${partId} .next-btn-wrapper`).style.display = 'none';
            if (gameState[partId].pool.length === 0) initPool(partId);
            const randomIdx = Math.floor(Math.random() * gameState[partId].pool.length);
            const questionIdx = gameState[partId].pool[randomIdx];
            gameState[partId].pool.splice(randomIdx, 1);
            
            const bank = partId === 'part1' ? bankPart1 : bankPart2;
            gameState[partId].currentData = bank[questionIdx];
            renderCard(partId, gameState[partId].currentData);
        }

        function renderCard(partId, data) {
            const container = document.getElementById(`quiz-container-${partId === 'part1' ? '1' : '2'}`);
            let optionsHtml = '';
            data.options.forEach((opt, index) => {
                optionsHtml += `<button class="btn-opt" onclick="checkAnswer(this, '${partId}', ${index})">${opt}</button>`;
            });
            const tagClass = partId === 'part1' ? 'tag-ident' : 'tag-scene';
            const tagText = partId === 'part1' ? data.type : data.tag;
            
            container.innerHTML = `
                <div class="quiz-card" style="animation: fadeIn 0.4s;">
                    <span class="tag ${tagClass}">${tagText}</span>
                    <div class="question-text">${data.q}</div>
                    <div class="options-grid" style="${data.options.length > 2 ? 'grid-template-columns: 1fr;' : 'grid-template-columns: 1fr 1fr;'}">${optionsHtml}</div>
                    <div class="feedback"></div>
                </div>`;
        }

        function checkAnswer(btn, partId, choiceIndex) {
            const data = gameState[partId].currentData;
            const parent = btn.parentElement;
            const feedback = parent.nextElementSibling;
            const card = btn.closest('.quiz-card');
            
            parent.querySelectorAll('.btn-opt').forEach(s => s.disabled = true);

            if (choiceIndex === data.answer) {
                // 答对了
                btn.classList.add('correct');
                feedback.innerHTML = `✅ <strong>正解！</strong><br>${data.explain}`;
                feedback.style.color = "#155724"; feedback.style.background = "#d4edda";
                card.style.borderLeftColor = "#28a745";
                updateCombo(true);
            } else {
                // 答错了
                btn.classList.add('wrong');
                parent.children[data.answer].classList.add('correct');
                feedback.innerHTML = `❌ <strong>遗憾...</strong><br>${data.explain}`;
                feedback.style.color = "#721c24"; feedback.style.background = "#f8d7da";
                card.style.borderLeftColor = "#dc3545";
                updateCombo(false);
                
                // --- 核心：记录错题 ---
                // 避免重复添加同一道题 (用题目内容去重)
                if(!gameState.mistakes.some(m => m.q === data.q)){
                    gameState.mistakes.push(data);
                    updateMistakeCount();
                }
            }
            feedback.style.display = 'block';
            document.querySelector(`#${partId} .next-btn-wrapper`).style.display = 'block';
        }

        function updateCombo(isSuccess) {
            const comboEl = document.getElementById('combo-display');
            const countEl = document.getElementById('combo-count');
            if (isSuccess) {
                gameState.combo++;
                countEl.innerText = gameState.combo;
                comboEl.style.opacity = '1';
                comboEl.style.transform = 'scale(1.1)';
                setTimeout(() => comboEl.style.transform = 'scale(1)', 200);
            } else {
                gameState.combo = 0;
                countEl.innerText = '0';
                comboEl.style.opacity = '0.5';
            }
        }

        // 更新错题数量显示
        function updateMistakeCount() {
            document.getElementById('mistake-count').innerText = gameState.mistakes.length;
        }

        // --- 新增：错题本视图切换 ---
        function toggleMistakeView() {
            const practiceSections = document.querySelectorAll('.quiz-section');
            const mistakeSection = document.getElementById('mistake-section');
            const btnPart1 = document.getElementById('btn-part1');
            const btnPart2 = document.getElementById('btn-part2');

            if (mistakeSection.style.display === 'none') {
                // 进入错题本模式：隐藏练习题，显示错题列表
                practiceSections.forEach(el => el.style.display = 'none');
                btnPart1.classList.remove('active');
                btnPart2.classList.remove('active');
                
                renderMistakes(); // 渲染列表
                mistakeSection.style.display = 'block';
            } else {
                // 退出错题本模式：恢复默认的 Part 1
                mistakeSection.style.display = 'none';
                switchPracticeMode('part1');
            }
        }

        // --- 新增：渲染错题列表 ---
        function renderMistakes() {
            const container = document.getElementById('mistake-container');
            
            if (gameState.mistakes.length === 0) {
                container.innerHTML = `<div style="text-align:center; padding:30px; color:#999; background:#fff; border-radius:10px;">👏 太棒了！本次暂无错题。</div>`;
                return;
            }

            let html = '';
            gameState.mistakes.forEach((data, i) => {
                const tagClass = data.tag ? 'tag-scene' : 'tag-ident';
                const tagText = data.tag || data.type;
                const correctAns = data.options[data.answer]; // 获取正确选项文字

                html += `
                    <div class="quiz-card" style="border-left-color: #dc3545;">
                        <span class="tag ${tagClass}">${tagText}</span>
                        <div class="question-text">${data.q}</div>
                        <div style="background:#f8d7da; padding:10px; border-radius:5px; color:#721c24; margin-top:10px;">
                            <strong>✅ 正解：${correctAns}</strong><br>
                            <span style="font-size:0.9em; opacity:0.8;">解析：${data.explain}</span>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        function resetGame() {
            if(!confirm("确定要重置吗？\n错题记录和连对都将清零。")) return;
            
            // 清空所有状态
            gameState.combo = 0;
            gameState.mistakes = []; 
            updateMistakeCount();
            
            document.getElementById('combo-count').innerText = '0';
            document.getElementById('combo-display').style.opacity = '0';
            
            initPool('part1'); initPool('part2');
            
            // 强制回到练习界面
            document.getElementById('mistake-section').style.display = 'none';
            switchPracticeMode('part1');
            nextQuestion('part1');
            nextQuestion('part2');
        }

        function switchMainTab(tabId) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            // 修正：由于第一个 .nav-item 是返回按钮，所以 tab 索引需要 +1
            const indexes = {'basic':1, 'special':2, 'practice':3};
            if(document.querySelectorAll('.nav-item')[indexes[tabId]]) {
                document.querySelectorAll('.nav-item')[indexes[tabId]].classList.add('active');
            }
            window.scrollTo(0,0);
        }

        function switchPracticeMode(modeId) {
            // 确保错题本关闭
            document.getElementById('mistake-section').style.display = 'none';
            
            document.querySelectorAll('.quiz-section').forEach(qs => qs.classList.remove('active'));
            document.querySelectorAll('.quiz-section').forEach(qs => qs.style.display = 'none'); // 强制隐藏
            
            document.querySelectorAll('.switch-btn').forEach(btn => btn.classList.remove('active'));
            
            // 激活当前板块
            const targetSection = document.getElementById(modeId);
            targetSection.classList.add('active');
            targetSection.style.display = 'block'; // 强制显示
            
            document.getElementById('btn-' + modeId).classList.add('active');
            
            // 如果空了就补题
            if(!document.querySelector(`#${modeId} .quiz-card`)) nextQuestion(modeId);
        }
    </script>
</body>
</html>